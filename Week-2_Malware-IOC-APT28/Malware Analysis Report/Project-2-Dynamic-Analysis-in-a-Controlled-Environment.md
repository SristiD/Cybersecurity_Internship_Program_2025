# 🧪 Project 2: Dynamic Analysis in a Controlled Environment

## 📌 Introduction
Dynamic analysis enables us to safely observe malware **at runtime**. The sample demonstrates persistence, payload delivery, and evasive behavior.

## 🧠 Pre-requisites
- Familiarity with VMs and system monitoring
- Ability to interpret runtime process behavior

## 🧪 Tools Used
- CAPEv2 Sandbox
- VirusTotal
- Hybrid Analysis

## ⚙️ Lab Setup
- 🖥️ Windows 11 64-bit VM (isolated)
- Network monitoring enabled
- Process & registry monitoring active

## 🔎 Observed Behavior (CAPEv2)
- 📌 **Persistence**: via Registry key
- 🌐 **Network**:
  - Connects to `.click`, `.ru`, `.pw`, `.xyz`, `.su`, `.info` domains
  - POSTs to `data/info.php`
- **Process Behavior**:
  - `rundll32.exe` used
  - `powershell.exe` executed as stager
  - Code injection detected
- **Payload Delivery**: HTTP POST to `data/info.php`
- 🕵️‍♂️ **Anti-analysis**:
  - Sleep cycles ≥ 3 minutes
  - Sandbox and debugger checks

## 🔍 VirusTotal MITRE ATT&CK Mapping
- **TA0002 Execution**: `GetProcAddress` (T1129)
- **TA0004/TA0005 Priv. Esc. & Evasion**:
  - Process Injection (T1055)
  - Cryptographic Keys: `CryptAcquireContext` (T1027)
  - Masquerading (T1036)
- **TA0007 Discovery**:
  - Application (T1010), Remote (T1018), System (T1082)
  - Security Software (T1518.001)
  - Language (T1614.001)
- **TA1497 Sandbox Evasion**
- **TA0011 C2**: DNS-based (T1071, T1095)

## ✅ Summary
The malware actively avoids analysis, injects into processes, and exfiltrates or retrieves data via stealthy C2 communication.
